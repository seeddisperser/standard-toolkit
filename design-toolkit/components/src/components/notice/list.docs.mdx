import { Canvas, Meta } from '@storybook/blocks';

import * as ListStories from './list.stories';

<Meta of={ListStories} />

# Notice.List
The Notice.List component provides queue management and display functionality for multiple notice notifications. It's built on React Aria Components and provides excellent accessibility out of the box. Notice lists are commonly used to manage system-wide notifications, user feedback queues, and alert systems that need to display multiple messages with automatic timeout and dismissal capabilities.

## Example usage

### Basic Queue Management
```tsx
import { useEmit } from '@accelint/bus/react';
import { NoticeEventTypes } from './events';

function App() {
  const emit = useEmit<NoticeQueueEvent>(NoticeEventTypes.queue);

  const addNotice = () => {
    emit({
      message: "This is a flexible notice that can be either a single or double line",
      color: "info",
      timeout: 5000
    });
  };

  return (
    <div>
      <Notice.List
        aria-label='notice-list'
        placement="top right"
        defaultColor="info"
        limit={3}
      />
      <Button onPress={addNotice}>Add Notice</Button>
    </div>
  );
}
```

<Canvas of={ListStories.Default} />

### Multiple Notice Lists
When you have multiple Notice.List on the page add a unique `aria-label` to each list
```tsx
// Create separate lists for different types of notifications
const infoListId = "info-notices";
const errorListId = "error-notices";

<div>
  <Notice.List
    id={infoListId}
    aria-label='info-notices'
    placement="top right"
    defaultColor="info"
    limit={5}
  />
  <Notice.List
    id={errorListId}
    aria-label='error-notices'
    placement="bottom right"
    defaultColor="critical"
    limit={3}
  />
</div>
```

### Targeted Queue Management
```tsx
// Queue notices to specific lists
emit({
  message: "Information message",
  target: infoListId,
  color: "info"
});

emit({
  message: "Error message",
  target: errorListId,
  color: "critical"
});
```

## Placement Options

* **top left** - Top left corner of the container
* **top** - Top center of the container
* **top right** - Top right corner of the container
* **right** - Middle right of the container
* **bottom right** - Bottom right corner of the container
* **bottom** - Bottom center of the container
* **bottom left** - Bottom left corner of the container
* **left** - Middle left of the container

## Props
The Notice.List component accepts all standard HTML div attributes

### Core Props
* **`id`** - Unique identifier for the notice list
* **`global`** - Render the list at the document root or inline: `boolean`
* **`placement`** - Position of notices: `'top left'` | `'top'` | `'top right'` | `'right'` | `'bottom right'` | `'bottom'` | `'bottom left'` | `'left'`
* **`limit`** - Maximum number of visible notices at once (default: 3)
* **`defaultColor`** - Default color for notices in this list: `'info'` | `'advisory'` | `'normal'` | `'serious'` | `'critical'`
* **`defaultTimeout`** - Default timeout duration in milliseconds
* **`hideClearAll`** - Whether to hide the "Clear All" button: `boolean`
* **`size`** - Default size for notices: `'medium'` (default) | `'small'`
- **`classNames`** - Optional class names for custom styling
  - `region` -  Class names applied to the region element
  - `list` -  Class names applied to the `ToastList` element
  - `button` -  Class names applied to the Clear All button
  - `notice` -  Class names applied to each `Notice`
    - `notice` - Class name applied to the container element
    - `content` - Class name applied to the content container
    - `actions` - Class name applied to the actions container

## Events
The Notice.List implements events via bus

### Events
* **`queue`** - Add an event to the queue
* **`dequeue`** - Remove an event from the queue
* **`actionPrimary`** - Primary button was pressed
* **`actionSecondary`** - Secondary button was pressed
* **`close`** - Close button was pressed

## Queue Management

The Notice.List component uses an event-driven architecture for queue management:

### Adding Notices
```tsx
import { useEmit } from '@accelint/bus/react';
import { NoticeEventTypes } from './events';

const emit = useEmit<NoticeQueueEvent>(NoticeEventTypes.queue);

// Basic notice
emit({
  message: "Operation completed successfully",
  color: "normal"
});

// Notice with custom timeout
emit({
  message: "Warning: Action required",
  color: "advisory",
  timeout: 10000
});

// Notice with actions
emit({
  message: "Delete item?",
  color: "critical",
  primary: { children: "Delete" },
  secondary: { children: "Cancel" }
});

// Notice with metadata for tracking
emit({
  message: "File uploaded",
  color: "info",
  metadata: { fileId: "123", userId: "user-456" }
});
```

### Removing Notices
```tsx
const dequeue = useEmit<NoticeDequeueEvent>(NoticeEventTypes.dequeue);

// Remove by notice ID
dequeue({ id: "b097015f-f8e1-4718-9910-7e16aa6f79d1" });

// Remove by color (all notices of that color)
dequeue({ color: "critical" });

// Remove by metadata (notices matching metadata criteria)
dequeue({ metadata: { category: "upload" } });

// Clear entire list
dequeue({ target: "ad709536-8aa6-4c53-96fd-9bf92380b97f" });
```

### Advanced Queue Examples

#### Dequeue by ID
Remove specific notices by their unique identifier:
```tsx
// Each notice gets a unique ID when queued
const noticeId = "baa2d245-354d-43a1-92b0-89ee242b5318";
emit({ id: noticeId, message: "Action completed" });

// Later, remove this specific notice
dequeue({ id: noticeId });
```

#### Dequeue by Color
Remove all notices of a specific type across lists:
```tsx
// Queue multiple error notices
emit({ message: "Error 1", color: "critical" });
emit({ message: "Error 2", color: "critical" });

// Clear all critical notices at once
dequeue({ color: "critical" });
```

#### Dequeue by Metadata
Remove notices based on custom metadata for complex filtering:
```tsx
// Queue notices with metadata
emit({
  message: "Upload started",
  metadata: { operation: "upload", fileId: "file-123" }
});

emit({
  message: "Processing file",
  metadata: { operation: "process", fileId: "file-123" }
});

// Remove all notices related to a specific file
dequeue({ metadata: { fileId: "file-123" } });
```

## Implementation Notes
The `Notice.List` component wraps the `ToastRegion` and `ToastQueue` components from `react-aria-components` and integrates with a custom event bus system for queue management.

[React Aria Toast Docs](https://react-spectrum.adobe.com/react-aria/Toast.html)

[Github Source](https://github.com/gohypergiant/standard-toolkit/tree/main/design-toolkit/components/src/components/notice)

The underlying elements are:
- `ToastRegion` with proper ARIA labeling
- `ToastList` for managing the queue of notices
- `PortalProvider` for rendering notices in the correct DOM location
- Individual `Toast` components wrapping each `Notice`

The component automatically handles accessibility features including:
- ARIA live regions for screen reader announcements
- Proper focus management when notices appear and disappear
- Keyboard navigation support
- Queue state announcements
- Automatic cleanup of expired notices

The notice list includes sophisticated queue management that handles:
- **Automatic timeout and dismissal** with configurable durations
- **Queue overflow management** respecting the configured limit
- **Multiple targeting strategies** for precise notice removal
- **Persistent state** across component re-renders
- **Event-driven architecture** enabling decoupled communication

The queue uses a first-in-first-out (FIFO) approach where new notices push out older ones when the limit is reached. The "Clear All" button provides users with quick access to dismiss all current notices, improving the overall user experience by preventing notification overflow.

All placement options provide consistent positioning relative to the parent container, with notices automatically stacking and animating smoothly during queue operations. The component integrates seamlessly with the broader event system, making it ideal for global notification management in complex applications.
